# Environment Variables Setup

## Overview
This document describes the environment variables needed for both backend and frontend applications.

---

## Backend (Laravel) Environment Variables

### Location
`/backend/.env`

### Setup
1. Copy the example file:
```bash
cd backend
cp .env.example .env
```

2. Generate application key:
```bash
php artisan key:generate
```

3. Configure the variables as needed

### Essential Variables

#### Application Settings
```env
APP_NAME=Ecommerce
APP_ENV=local                    # local, staging, production
APP_KEY=                         # Auto-generated by artisan key:generate
APP_DEBUG=true                   # Set to false in production
APP_URL=http://localhost:8000
```

#### Frontend CORS Configuration
```env
FRONTEND_URL=http://localhost:3000
# In production, set to your actual frontend URL
# FRONTEND_URL=https://yourdomain.com
```

#### Database Configuration
**SQLite (Default for Development):**
```env
DB_CONNECTION=sqlite
# Database file is created at: database/database.sqlite
```

**MySQL (Recommended for Production):**
```env
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=ecommerce
DB_USERNAME=root
DB_PASSWORD=your_password
```

**PostgreSQL:**
```env
DB_CONNECTION=pgsql
DB_HOST=127.0.0.1
DB_PORT=5432
DB_DATABASE=ecommerce
DB_USERNAME=postgres
DB_PASSWORD=your_password
```

#### Cache & Session
```env
CACHE_STORE=database             # file, database, redis
SESSION_DRIVER=database          # file, cookie, database, redis
QUEUE_CONNECTION=database        # sync, database, redis
```

#### Mail Configuration
**Development (Log emails to file):**
```env
MAIL_MAILER=log
```

**Production (SMTP):**
```env
MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=your_username
MAIL_PASSWORD=your_password
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS="noreply@yourdomain.com"
MAIL_FROM_NAME="${APP_NAME}"
```

**Using Services:**
```env
# Mailgun
MAIL_MAILER=mailgun
MAILGUN_DOMAIN=your-domain.com
MAILGUN_SECRET=your-secret-key

# SendGrid
MAIL_MAILER=smtp
MAIL_HOST=smtp.sendgrid.net
MAIL_PORT=587
MAIL_USERNAME=apikey
MAIL_PASSWORD=your-sendgrid-api-key
```

#### File Storage
**Local Storage (Default):**
```env
FILESYSTEM_DISK=local
```

**Amazon S3:**
```env
FILESYSTEM_DISK=s3
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=your-bucket-name
AWS_USE_PATH_STYLE_ENDPOINT=false
```

#### Authentication (Laravel Sanctum)
```env
SANCTUM_STATEFUL_DOMAINS=localhost,localhost:3000,127.0.0.1,127.0.0.1:3000
```

#### Payment Gateway (To be configured)
**Stripe:**
```env
STRIPE_KEY=pk_test_your_stripe_public_key
STRIPE_SECRET=sk_test_your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret
```

**PayPal:**
```env
PAYPAL_MODE=sandbox              # sandbox or live
PAYPAL_CLIENT_ID=your_client_id
PAYPAL_SECRET=your_secret
```

#### Redis (Optional, for better performance)
```env
REDIS_CLIENT=phpredis
REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379
REDIS_DB=0
REDIS_CACHE_DB=1
```

#### Broadcasting (Optional, for real-time features)
```env
BROADCAST_CONNECTION=pusher

PUSHER_APP_ID=your_app_id
PUSHER_APP_KEY=your_app_key
PUSHER_APP_SECRET=your_app_secret
PUSHER_APP_CLUSTER=mt1
```

#### Logging
```env
LOG_CHANNEL=stack                # single, daily, slack, etc.
LOG_LEVEL=debug                  # debug, info, warning, error
```

#### Error Tracking (Sentry)
```env
SENTRY_LARAVEL_DSN=your-sentry-dsn
SENTRY_TRACES_SAMPLE_RATE=1.0
```

---

## Frontend (Next.js) Environment Variables

### Location
`/frontend/.env.local`

### Setup
1. Copy the example file:
```bash
cd frontend
cp .env.local.example .env.local
```

2. Configure the variables

### Essential Variables

#### API Configuration
```env
# Backend API URL
NEXT_PUBLIC_API_URL=http://localhost:8000/api/v1

# Frontend URL
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

#### Application Settings
```env
NEXT_PUBLIC_APP_NAME="E-Commerce Store"
NEXT_PUBLIC_APP_DESCRIPTION="Modern e-commerce platform"
```

#### Feature Flags
```env
NEXT_PUBLIC_ENABLE_REVIEWS=true
NEXT_PUBLIC_ENABLE_WISHLIST=true
NEXT_PUBLIC_ENABLE_GUEST_CHECKOUT=true
```

#### Pagination
```env
NEXT_PUBLIC_PRODUCTS_PER_PAGE=12
NEXT_PUBLIC_ORDERS_PER_PAGE=10
```

#### Image Configuration
```env
# Image CDN URL (optional)
NEXT_PUBLIC_IMAGE_CDN_URL=https://cdn.yourdomain.com
```

#### Payment Gateway
**Stripe (Client-side):**
```env
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_public_key
```

#### Analytics & Tracking (Optional)
```env
# Google Analytics
NEXT_PUBLIC_GA_TRACKING_ID=G-XXXXXXXXXX

# Facebook Pixel
NEXT_PUBLIC_FACEBOOK_PIXEL_ID=your_pixel_id

# Google Tag Manager
NEXT_PUBLIC_GTM_ID=GTM-XXXXXXX
```

#### Map Services (Optional)
```env
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=your_google_maps_key
```

#### Social Media (Optional)
```env
NEXT_PUBLIC_FACEBOOK_URL=https://facebook.com/yourpage
NEXT_PUBLIC_TWITTER_URL=https://twitter.com/yourhandle
NEXT_PUBLIC_INSTAGRAM_URL=https://instagram.com/yourhandle
```

---

## Environment-Specific Configurations

### Development
**Backend (.env):**
```env
APP_ENV=local
APP_DEBUG=true
APP_URL=http://localhost:8000
DB_CONNECTION=sqlite
MAIL_MAILER=log
CACHE_STORE=file
```

**Frontend (.env.local):**
```env
NEXT_PUBLIC_API_URL=http://localhost:8000/api/v1
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

### Staging
**Backend (.env):**
```env
APP_ENV=staging
APP_DEBUG=true
APP_URL=https://api-staging.yourdomain.com
DB_CONNECTION=mysql
MAIL_MAILER=smtp
CACHE_STORE=redis
```

**Frontend (.env.production):**
```env
NEXT_PUBLIC_API_URL=https://api-staging.yourdomain.com/api/v1
NEXT_PUBLIC_APP_URL=https://staging.yourdomain.com
```

### Production
**Backend (.env):**
```env
APP_ENV=production
APP_DEBUG=false
APP_URL=https://api.yourdomain.com
DB_CONNECTION=mysql
MAIL_MAILER=smtp
CACHE_STORE=redis
QUEUE_CONNECTION=redis
SESSION_DRIVER=redis
```

**Frontend (.env.production):**
```env
NEXT_PUBLIC_API_URL=https://api.yourdomain.com/api/v1
NEXT_PUBLIC_APP_URL=https://yourdomain.com
```

---

## Security Best Practices

### 1. Never Commit .env Files
- `.env` files are in `.gitignore`
- Only commit `.env.example` files
- Keep sensitive data out of version control

### 2. Use Strong Keys
```bash
# Laravel automatically generates a strong APP_KEY
php artisan key:generate
```

### 3. Rotate Secrets Regularly
- Database passwords
- API keys
- Payment gateway credentials
- Third-party service tokens

### 4. Use Different Credentials Per Environment
- Never use production credentials in development
- Use test/sandbox credentials for development
- Use separate databases per environment

### 5. Restrict Access
- Use environment variable management tools
- Limit who can access production credentials
- Use secrets management services (AWS Secrets Manager, HashiCorp Vault)

### 6. Use Environment-Specific Prefixes
```env
# Instead of generic names
STRIPE_KEY=...

# Use specific prefixes
STRIPE_LIVE_KEY=...
STRIPE_TEST_KEY=...
```

---

## Environment Variable Management Tools

### 1. Laravel Forge
- Built-in environment variable management
- Easy updates through web interface
- Automatic deployment on change

### 2. Docker
```yaml
# docker-compose.yml
services:
  backend:
    env_file:
      - ./backend/.env
  frontend:
    env_file:
      - ./frontend/.env.local
```

### 3. Vercel (for Next.js)
- Environment variables in project settings
- Supports multiple environments
- Encrypted at rest

### 4. GitHub Secrets
- Store secrets for CI/CD
- Use in GitHub Actions workflows
- Encrypted and not visible in logs

---

## Troubleshooting

### Laravel: "APP_KEY not set"
```bash
php artisan key:generate
```

### Next.js: Environment variables not working
- Variables must start with `NEXT_PUBLIC_` to be available in browser
- Restart dev server after changing .env.local
- Check that .env.local is not in .gitignore

### Database connection issues
- Verify database credentials
- Check database server is running
- Ensure database exists
- Check firewall rules

### CORS issues
- Verify FRONTEND_URL in backend .env
- Check CORS configuration in config/cors.php
- Ensure credentials are sent with requests

---

## Quick Reference

### Backend Environment Files
```
backend/
├── .env                    # Main environment file (not committed)
├── .env.example            # Example template (committed)
├── .env.testing            # Testing environment (optional)
└── config/                 # Configuration files that read from .env
```

### Frontend Environment Files
```
frontend/
├── .env.local              # Local development (not committed)
├── .env.local.example      # Example template (committed)
├── .env.development        # Development environment
├── .env.staging            # Staging environment
└── .env.production         # Production environment
```

---

**Last Updated**: October 27, 2025
**Configuration Status**: Initial Setup

